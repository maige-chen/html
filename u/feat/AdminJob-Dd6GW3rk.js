import{_ as k,R as g,W as I}from"./JobForm.vue_vue_type_script_setup_true_lang-TIQYUcgr.js";import{d as T,u as V,r as x,b as r,c as u,o as l,e as d,g as D,w as _,F as E,j as M,k as c,f as C,i as w,t as v,h as f,s as R,C as S,x as P}from"./main-tl-mSqkc.js";import"./PatternUtil-DSsBJKfN.js";const U={deleteById:(s,e)=>{for(let t=0;t<s.length;t++)if(s[t].id==e){s.splice(t,1);break}},toIdFlat:(s,e)=>{let t=new Map;for(let i=0;i<s.length;i++){const a=s[i];a&&t.set(a.id,a[e])}return t},ikMap:(s,e)=>{let t=new Map;if(s==null)return t;for(let i=0;i<s.length;i++){const a=s[i];if(!a)continue;const m=String(a[e]);a.idx=i,t.set(m,a)}return t}},W={key:0},O={class:"me-1"},Y=["onClick"],q=["onClick"],z={key:0},G={key:1},H={key:2},K={key:3},ee=T({__name:"AdminJob",setup(s){const e=V(),t=x(!1);function i(p,n){n!=null&&R({title:"确定删除吗？"}).then(()=>{S(n).then(b=>{b===!0&&(e.jobList.splice(p,1),U.deleteById(e.todayJobList,n))})}).catch(()=>{})}const a=x(!1);function m(){e.jobFinished||P(e.jobPn).then(p=>{e.jobList.push(...p.data),p.hasNext?e.jobPn+=1:e.jobFinished=!0})}function j(p){e.currentJob=e.jobList[p]}return(p,n)=>{const b=r("van-nav-bar"),J=r("van-icon"),F=r("van-tag"),L=r("van-space"),A=r("van-cell"),B=r("van-list"),N=r("van-button"),$=r("van-overlay");return l(),u("div",null,[d(b,{title:"成就库","right-text":t.value?"隐藏":"添加",onClickRight:n[0]||(n[0]=o=>t.value=!t.value)},null,8,["right-text"]),t.value?(l(),u("div",W,[d(k)])):D("",!0),d(B,{loading:a.value,"onUpdate:loading":n[1]||(n[1]=o=>a.value=o),finished:c(e).jobFinished,"finished-text":"没有更多了",onLoad:m},{default:_(()=>[(l(!0),u(E,null,M(c(e).jobList,(o,y)=>(l(),C(A,{key:o.id,center:""},{title:_(()=>[f("span",O,v(o.title),1),d(F,{type:"primary",class:"px-1"},{default:_(()=>[w(" +"+v(o.award)+" ",1),d(J,{name:"cash-o"})]),_:2},1024)]),value:_(()=>[d(L,null,{default:_(()=>[f("span",{class:"text-primary",onClick:h=>j(y),role:"button"},"修改",8,Y),f("span",{class:"text-danger",onClick:h=>i(y,o.id),role:"button"},"删除",8,q)]),_:2},1024)]),label:_(()=>[n[3]||(n[3]=w(" 重复: ",-1)),o.repeatType===c(g).ONCE?(l(),u("span",z,"仅一次")):o.repeatType===c(g).DAILY?(l(),u("span",G,"每天")):Array.isArray(o.weekdays)?(l(),u("span",H,v(o.weekdays.map(h=>c(I)[h]).join(" ")),1)):(l(),u("span",K,v(o.weekdays),1))]),_:2},1024))),128))]),_:1},8,["loading","finished"]),d($,{show:c(e).currentJob!=null},{default:_(()=>[d(N,{icon:"cross",class:"border-0 bg-transparent text-light float-end",onClick:n[2]||(n[2]=o=>c(e).currentJob=void 0)}),n[4]||(n[4]=f("div",{id:"placeholder",style:{height:"50px"}},null,-1)),(l(),C(k,{key:c(e).currentJob?.id}))]),_:1},8,["show"])])}}});export{ee as default};
