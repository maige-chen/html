import{d as S,k as E,u as V,r,b as s,c as v,e as d,f as i,i as o,g as a,F as g,p as h,l as x,q as D,t as C,j,v as q}from"./main-CXNK52Lh.js";import{R as w}from"./Enums-glG3HjMS.js";import{c as X}from"./Copy-D3M30aPW.js";import{I as T}from"./borrow-Dox9yQAn.js";const z="/u/#/i?c=",O=S({__name:"Invite",setup(G){const $=E(),n=V(),b=BASE_URL+z,k=r(0),L=r(!1),F=r(!1),y=r(!1),u={active:"active",used:"used",expired:"expired"};function c(l){switch(l){case"used":if(n.uFinished)return;break;case"expired":if(n.eFinished)return;break;default:if(n.aFinished)return}T.list(l,n.aPn).then(e=>{if(e==null||e.data==null){l===u.used&&(n.uFinished=!0),l===u.expired&&(n.eFinished=!0),l===u.active&&(n.aFinished=!0);return}switch(l){case"used":n.uList.push(...e.data),e.hasNext?n.uPn+=1:n.uFinished=!0;break;case"expired":n.eList.push(...e.data),e.hasNext?n.ePn+=1:n.eFinished=!0;break;default:n.aList.push(...e.data),e.hasNext?n.aPn+=1:n.aFinished=!0}})}function N(l){q({title:"确定删除吗？"}).then(()=>{const e=n.aList[l]?.id;e!==void 0&&T.del(e).then(p=>{p===!0&&n.aList.splice(l,1)})}).catch(()=>{})}return(l,e)=>{const p=s("van-nav-bar"),B=s("van-tag"),f=s("van-cell"),P=s("van-button"),R=s("van-swipe-cell"),_=s("van-list"),m=s("van-tab"),U=s("van-tabs");return d(),v("div",null,[i(p,{title:"邀请码","left-arrow":"",onClickLeft:e[0]||(e[0]=t=>o($).replace("/"))}),i(U,{active:k.value,"onUpdate:active":e[7]||(e[7]=t=>k.value=t)},{default:a(()=>[i(m,{title:"邀请中"},{default:a(()=>[i(_,{loading:L.value,"onUpdate:loading":e[1]||(e[1]=t=>L.value=t),finished:o(n).aFinished,"finished-text":"没有更多了",onLoad:e[2]||(e[2]=t=>c(u.active))},{default:a(()=>[(d(!0),v(g,null,h(o(n).aList,(t,A)=>(d(),x(R,{key:t.id},{right:a(()=>[i(P,{type:"danger",text:"删除",onClick:I=>N(A)},null,8,["onClick"])]),default:a(()=>[i(f,{icon:"gift-card",value:"复制",label:b+t.code,"title-style":"flex-basis:160px; flex-grow: 1 !important",onClick:I=>o(X)(b+t.code)},{title:a(()=>[D("span",null,C(t.storeTitle),1),i(B,{type:"primary",class:"ms-1"},{default:a(()=>[j(C(o(w)[t.roles]),1)]),_:2},1024)]),_:2},1032,["label","onClick"])]),_:2},1024))),128))]),_:1},8,["loading","finished"])]),_:1}),i(m,{title:"已使用"},{default:a(()=>[i(_,{loading:F.value,"onUpdate:loading":e[3]||(e[3]=t=>F.value=t),finished:o(n).uFinished,"finished-text":"没有更多了",onLoad:e[4]||(e[4]=t=>c(u.used))},{default:a(()=>[(d(!0),v(g,null,h(o(n).uList,t=>(d(),x(f,{key:t.id,icon:"success",title:t.groupTitle?t.groupTitle:t.storeTitle,value:o(w)[t.roles]},null,8,["title","value"]))),128))]),_:1},8,["loading","finished"])]),_:1}),i(m,{title:"已失效"},{default:a(()=>[i(_,{loading:y.value,"onUpdate:loading":e[5]||(e[5]=t=>y.value=t),finished:o(n).eFinished,"finished-text":"没有更多了",onLoad:e[6]||(e[6]=t=>c(u.expired))},{default:a(()=>[(d(!0),v(g,null,h(o(n).eList,t=>(d(),x(f,{key:t.id,icon:"cross",title:t.storeTitle,value:t.expiredAt},null,8,["title","value"]))),128))]),_:1},8,["loading","finished"])]),_:1})]),_:1},8,["active"])])}}});export{O as default};
