import{d as G,k as H,u as J,r as v,o as K,b as a,c as V,e as d,f as o,l as b,m as x,g as t,i as $,j as p,t as h,F as O,p as P,q as I,v as Q,x as W}from"./main-CXNK52Lh.js";import{S as u,I as X}from"./borrow-Dox9yQAn.js";import{c as Y}from"./Copy-D3M30aPW.js";const Z=["onClick"],le=G({__name:"Store",setup(ee){const A=H(),s=J(),m=v(!1),i=v("");function B(){const n={title:i.value};u.add(n).then(e=>{s.storeList.push(e),m.value=!1,u.clear()})}function N(){u.all().then(n=>s.storeList=n)}function U(n){Q({title:"确定删除吗？"}).then(()=>{const e=s.storeList[n]?.id;e!==void 0&&u.del(e).then(r=>{r===!0&&(s.storeList.splice(n,1),u.clear())})}).catch(()=>{})}const _=v(!1);function E(n){s.storeIdx=n;const e=s.storeList[n];e&&(i.value=e.title),_.value=!0}function q(n){if(n==="cancel")return!0;const e=s.storeList[s.storeIdx];return!e||e&&i.value===e.title?!0:u.update(e.id,i.value).then(r=>r===null?(W("修改失败"),!1):(e.title=r.title,u.clear(),!0))}const g=v(!1),C=v("");function y(n,e){const r={storeId:n,roles:e,groupId:""};X.add(r).then(f=>{const c=BASE_URL+"/u/#/i?c="+f.code;C.value=c,g.value=!0,Y(c),s.addActive(f)})}return K(()=>{N()}),(n,e)=>{const r=a("van-icon"),f=a("van-nav-bar"),c=a("van-button"),w=a("van-field"),z=a("van-cell-group"),D=a("van-form"),F=a("van-notice-bar"),L=a("van-tag"),M=a("van-space"),R=a("van-cell"),j=a("van-swipe-cell"),T=a("van-dialog");return d(),V("div",null,[o(f,{title:"门店管理","left-arrow":"",onClickLeft:e[1]||(e[1]=l=>$(A).replace("/"))},{right:t(()=>[o(r,{name:"shop",size:"24",onClick:e[0]||(e[0]=l=>m.value=!m.value)})]),_:1}),m.value?(d(),b(D,{key:0,onSubmit:B},{default:t(()=>[o(z,{inset:"",class:"border mt-2"},{default:t(()=>[o(w,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value=l),placeholder:"请输入门店名称",rules:[{required:!0,message:"请填写门店名称"}]},{button:t(()=>[o(c,{size:"small",type:"primary","native-type":"submit"},{default:t(()=>[...e[6]||(e[6]=[p(" 添加门店 ",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):x("",!0),g.value?(d(),b(F,{key:1,scrollable:!1},{"right-icon":t(()=>[o(r,{name:"cross",onClick:e[3]||(e[3]=l=>g.value=!1)})]),default:t(()=>[p(h(C.value)+" ",1)]),_:1})):x("",!0),(d(!0),V(O,null,P($(s).storeList,(l,S)=>(d(),b(j,{key:l.id},{right:t(()=>[o(c,{square:"",type:"danger",text:"删除",onClick:k=>U(S)},null,8,["onClick"])]),default:t(()=>[o(R,{icon:"shop-o","title-style":"flex-basis:160px; flex-grow: 1 !important"},{title:t(()=>[I("span",null,h(l.title),1),o(M,null,{default:t(()=>[o(L,{type:"primary",class:"ms-1",onClick:k=>y(l.id,"StoreManager")},{default:t(()=>[...e[7]||(e[7]=[p(" 邀店长 ",-1)])]),_:1},8,["onClick"]),o(L,{type:"primary",onClick:k=>y(l.id,"StoreClerk")},{default:t(()=>[...e[8]||(e[8]=[p("店员",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),value:t(()=>[I("span",{onClick:k=>E(S)},[e[9]||(e[9]=p("修改",-1)),o(r,{name:"edit"})],8,Z)]),_:2},1024)]),_:2},1024))),128)),o(T,{show:_.value,"onUpdate:show":e[5]||(e[5]=l=>_.value=l),title:"修改标题","show-cancel-button":"","before-close":q},{default:t(()=>[o(w,{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=l=>i.value=l),label:"门店:",class:"my-3 grow-value",style:{"--van-field-label-width":"3em"}},null,8,["modelValue"])]),_:1},8,["show"])])}}});export{le as default};
