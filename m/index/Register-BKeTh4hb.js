import{d as h,k as x,c as q,a as t,r as o,w as n,u as k,f,e as p,l as z,o as M,M as N}from"./index-DdgynfoC.js";import{r as U}from"./login-DdgDhc7Z.js";import{a as _,s as B}from"./api-B0tRvhRj.js";const C={mobile:/^1[3456789][0-9]{9}$/},E=h({__name:"Register",setup(Q){const d=z(),v=C.mobile,a=x({usr:"",pwd:""});let s="";function b(){if(!d.query.c)return _({title:"暂未开放注册",message:"当前暂未开放注册, 注册需要邀请码。或使用下方的免注册方式登录!",theme:"round-button"}).then(()=>{}),!1;s=a.pwd===""?Math.floor(Math.random()*9e5)+1e5+"":a.pwd;const i={usr:a.usr,pwd:finger.hash(s),invite:d.query.c+"",p:finger.print()};U(i).then(e=>{_({message:"请记住密码: "+s}).then(()=>{N.cache(e,!0)})}).catch(e=>B(e))}return(i,e)=>{const w=o("van-nav-bar"),m=o("van-field"),g=o("van-cell-group"),y=o("van-button"),c=o("van-row"),V=o("van-form"),l=o("van-col"),r=o("van-icon");return M(),q("div",null,[t(w,{title:"注册"}),t(V,{onSubmit:b},{default:n(()=>[t(g,{inset:"",class:"border mt-5"},{default:n(()=>[t(m,{modelValue:a.usr,"onUpdate:modelValue":e[0]||(e[0]=u=>a.usr=u),required:"",label:"+86",placeholder:"请输入手机号码",rules:[{pattern:k(v),message:"请填写正确的手机号码."}],style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue","rules"]),t(m,{modelValue:a.pwd,"onUpdate:modelValue":e[1]||(e[1]=u=>a.pwd=u),label:"密码",type:"password",placeholder:"不填时随机生成",style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue"])]),_:1}),t(c,{gutter:"20",class:"p-3"},{default:n(()=>[t(y,{type:"success",size:"small",block:"","native-type":"submit"},{default:n(()=>[...e[2]||(e[2]=[f("注册",-1)])]),_:1})]),_:1})]),_:1}),t(c,{gutter:"20",class:"p-3 text-center text-body-tertiary"},{default:n(()=>[t(l,{span:"24",class:"mb-2"},{default:n(()=>[...e[3]||(e[3]=[f("免注册登陆",-1)])]),_:1}),t(l,{span:"8"},{default:n(()=>[t(r,{name:"wechat",color:"#67c23a",size:"24"}),e[4]||(e[4]=p("span",null,"微信",-1))]),_:1}),t(l,{span:"8"},{default:n(()=>[t(r,{name:"weibo",color:"#ee0a24",size:"24"}),e[5]||(e[5]=p("span",null,"微博",-1))]),_:1}),t(l,{span:"8"},{default:n(()=>[t(r,{name:"qq",color:"rgb(64, 158, 255",size:"24"}),e[6]||(e[6]=p("span",null,"QQ",-1))]),_:1})]),_:1})])}}});export{E as default};
