import{d as x,k as q,l as z,c as h,a as n,r as a,w as o,u as B,m as v,f as i,e as u,o as p,M}from"./index-DcX5xfsC.js";import{r as N}from"./login-DYejTmG_.js";import{a as b,s as U}from"./api-VRXDL6XW.js";const C={mobile:/^1[3456789][0-9]{9}$/},D=x({__name:"Register",setup(Q){const d=z(),w=C.mobile,t=q({usr:"",pwd:"",i:"",p:""});d.query.i&&(t.i=d.query.i.toString());function g(){if(t.i==="")return b({title:"暂未开放注册",message:"注册需要邀请码, 请联系管理员获取!",theme:"round-button"}).then(()=>{}),!1;t.pwd=t.pwd===""?Math.floor(Math.random()*9e5)+1e5+"":t.pwd;const m={usr:t.usr,pwd:finger.hash(t.pwd),invite:t.i,p:finger.print()};N(m).then(e=>{b({message:"请记住密码: "+t.pwd}).then(()=>{M.cache(e,!0)})}).catch(e=>U(e.msg))}return(m,e)=>{const y=a("van-nav-bar"),c=a("van-field"),V=a("van-cell-group"),f=a("van-button"),_=a("van-row"),k=a("van-form"),l=a("van-col"),s=a("van-icon");return p(),h("div",null,[n(y,{title:"注册"}),n(k,{onSubmit:g},{default:o(()=>[n(V,{inset:"",class:"border mt-5"},{default:o(()=>[n(c,{modelValue:t.usr,"onUpdate:modelValue":e[0]||(e[0]=r=>t.usr=r),required:"",label:"+86",placeholder:"请输入手机号码",rules:[{pattern:B(w),message:"请填写正确的手机号码."}],style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue","rules"]),n(c,{modelValue:t.pwd,"onUpdate:modelValue":e[1]||(e[1]=r=>t.pwd=r),label:"密码",type:"password",placeholder:"不填时随机生成",style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue"])]),_:1}),n(_,{gutter:"20",class:"p-3"},{default:o(()=>[t.i===""?(p(),v(f,{key:0,block:"",size:"small",type:"primary",disabled:!0},{default:o(()=>[...e[2]||(e[2]=[i(" 缺少邀请码 ",-1)])]),_:1})):(p(),v(f,{key:1,type:"success",size:"small",block:"","native-type":"submit"},{default:o(()=>[...e[3]||(e[3]=[i(" 注册 ",-1)])]),_:1}))]),_:1})]),_:1}),n(_,{gutter:"20",class:"p-3 text-center text-body-tertiary d-none"},{default:o(()=>[n(l,{span:"24",class:"mb-2"},{default:o(()=>[...e[4]||(e[4]=[i("免注册登陆",-1)])]),_:1}),n(l,{span:"8"},{default:o(()=>[n(s,{name:"wechat",color:"#67c23a",size:"24"}),e[5]||(e[5]=u("span",null,"微信",-1))]),_:1}),n(l,{span:"8"},{default:o(()=>[n(s,{name:"weibo",color:"#ee0a24",size:"24"}),e[6]||(e[6]=u("span",null,"微博",-1))]),_:1}),n(l,{span:"8"},{default:o(()=>[n(s,{name:"qq",color:"rgb(64, 158, 255",size:"24"}),e[7]||(e[7]=u("span",null,"QQ",-1))]),_:1})]),_:1})])}}});export{D as default};
