import{d as x,M as v,b as C,l as R,m as q,c as z,a as o,r as a,w as n,u as B,p as b,g as i,f as u,o as p}from"./index-CPpywXq0.js";import{r as M}from"./login-DZPmImDa.js";import{S as g}from"./Enums-Di78guLT.js";import{a as w,s as N}from"./api-Cp7J2pUi.js";const U={mobile:/^1[3456789][0-9]{9}$/},Q=x({__name:"Register",setup(H){const y=U.mobile,S=C(),m=q();v.isLoggedin()&&S.push("/");const t=R({usr:"",pwd:"",i:"",p:""});m.query.i&&(t.i=m.query.i.toString());function V(){if(t.i==="")return w({title:"暂未开放注册",message:"注册需要邀请码, 请联系管理员获取!",theme:"round-button"}).then(()=>{}),!1;t.pwd=t.pwd===""?Math.floor(Math.random()*9e5)+1e5+"":t.pwd;const d={usr:t.usr,pwd:finger.hash(t.pwd),invite:t.i,p:finger.print()};M(d).then(e=>{e.app==="CARWASH"&&(localStorage.setItem(LSK.home,"/m/"+g.CARWASH.home),localStorage.setItem(LSK.backurl,"/m/"+g.CARWASH.home)),w({message:"请记住密码: "+t.pwd}).then(()=>{v.cache(e,!0)})}).catch(e=>N(e.msg))}return(d,e)=>{const h=a("van-nav-bar"),c=a("van-field"),k=a("van-cell-group"),f=a("van-button"),_=a("van-row"),A=a("van-form"),s=a("van-col"),l=a("van-icon");return p(),z("div",null,[o(h,{title:"注册"}),o(A,{onSubmit:V},{default:n(()=>[o(k,{inset:"",class:"border mt-5"},{default:n(()=>[o(c,{modelValue:t.usr,"onUpdate:modelValue":e[0]||(e[0]=r=>t.usr=r),required:"",label:"+86",placeholder:"请输入手机号码",rules:[{pattern:B(y),message:"请填写正确的手机号码."}],style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue","rules"]),o(c,{modelValue:t.pwd,"onUpdate:modelValue":e[1]||(e[1]=r=>t.pwd=r),label:"密码",type:"password",placeholder:"不填时随机生成",style:{"--van-field-label-width":"2.5em"}},null,8,["modelValue"])]),_:1}),o(_,{gutter:"20",class:"p-3"},{default:n(()=>[t.i===""?(p(),b(f,{key:0,block:"",size:"small",type:"primary",disabled:!0},{default:n(()=>[...e[2]||(e[2]=[i(" 缺少邀请码 ",-1)])]),_:1})):(p(),b(f,{key:1,type:"success",size:"small",block:"","native-type":"submit"},{default:n(()=>[...e[3]||(e[3]=[i(" 注册 ",-1)])]),_:1}))]),_:1})]),_:1}),o(_,{gutter:"20",class:"p-3 text-center text-body-tertiary d-none"},{default:n(()=>[o(s,{span:"24",class:"mb-2"},{default:n(()=>[...e[4]||(e[4]=[i("免注册登陆",-1)])]),_:1}),o(s,{span:"8"},{default:n(()=>[o(l,{name:"wechat",color:"#67c23a",size:"24"}),e[5]||(e[5]=u("span",null,"微信",-1))]),_:1}),o(s,{span:"8"},{default:n(()=>[o(l,{name:"weibo",color:"#ee0a24",size:"24"}),e[6]||(e[6]=u("span",null,"微博",-1))]),_:1}),o(s,{span:"8"},{default:n(()=>[o(l,{name:"qq",color:"rgb(64, 158, 255",size:"24"}),e[7]||(e[7]=u("span",null,"QQ",-1))]),_:1})]),_:1})])}}});export{Q as default};
